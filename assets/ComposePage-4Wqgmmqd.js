var N=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var a=(s,t,e)=>(N(s,t,"read from private field"),e?e.call(s):t.get(s)),m=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},p=(s,t,e,r)=>(N(s,t,"write to private field"),r?r.call(s,e):t.set(s,e),e);var x=(s,t,e)=>(N(s,t,"access private method"),e);import{S as P,s as R,l as C,m as q,g as E,k as A,r as y,G as z,o as B,A as D,j as i,Q as K}from"./index-NYLOCjoL.js";import{s as L}from"./useAxios-6OaYkf_k.js";import{u as I}from"./useEndpoints-I-AXIl0L.js";import{B as Q}from"./btnLoader-nBJI4yfs.js";var c,h,o,d,v,k,w,S,O,V=(O=class extends P{constructor(t,e){super();m(this,v);m(this,w);m(this,c,void 0);m(this,h,void 0);m(this,o,void 0);m(this,d,void 0);p(this,h,void 0),p(this,c,t),this.setOptions(e),this.bindMethods(),x(this,v,k).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const e=this.options;this.options=a(this,c).defaultMutationOptions(t),R(e,this.options)||a(this,c).getMutationCache().notify({type:"observerOptionsUpdated",mutation:a(this,o),observer:this}),(r=a(this,o))==null||r.setOptions(this.options),e!=null&&e.mutationKey&&this.options.mutationKey&&C(e.mutationKey)!==C(this.options.mutationKey)&&this.reset()}onUnsubscribe(){var t;this.hasListeners()||(t=a(this,o))==null||t.removeObserver(this)}onMutationUpdate(t){x(this,v,k).call(this),x(this,w,S).call(this,t)}getCurrentResult(){return a(this,h)}reset(){var t;(t=a(this,o))==null||t.removeObserver(this),p(this,o,void 0),x(this,v,k).call(this),x(this,w,S).call(this)}mutate(t,e){var r;return p(this,d,e),(r=a(this,o))==null||r.removeObserver(this),p(this,o,a(this,c).getMutationCache().build(a(this,c),this.options)),a(this,o).addObserver(this),a(this,o).execute(t)}},c=new WeakMap,h=new WeakMap,o=new WeakMap,d=new WeakMap,v=new WeakSet,k=function(){var e;const t=((e=a(this,o))==null?void 0:e.state)??q();p(this,h,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},w=new WeakSet,S=function(t){E.batch(()=>{var e,r,l,b,u,n,f,M;if(a(this,d)&&this.hasListeners()){const g=a(this,h).variables,j=a(this,h).context;(t==null?void 0:t.type)==="success"?((r=(e=a(this,d)).onSuccess)==null||r.call(e,t.data,g,j),(b=(l=a(this,d)).onSettled)==null||b.call(l,t.data,null,g,j)):(t==null?void 0:t.type)==="error"&&((n=(u=a(this,d)).onError)==null||n.call(u,t.error,g,j),(M=(f=a(this,d)).onSettled)==null||M.call(f,void 0,t.error,g,j))}this.listeners.forEach(g=>{g(a(this,h))})})},O);function F(s,t){const e=A(t),[r]=y.useState(()=>new V(e,s));y.useEffect(()=>{r.setOptions(s)},[r,s]);const l=y.useSyncExternalStore(y.useCallback(u=>r.subscribe(E.batchCalls(u)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),b=y.useCallback((u,n)=>{r.mutate(u,n).catch(U)},[r]);if(l.error&&L(r.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:b,mutateAsync:l.mutate}}function U(){}function G(s){return z({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"}},{tag:"path",attr:{d:"M14.002 13a2 2 0 0 1-2 2h-10a2 2 0 0 1-2-2V5A2 2 0 0 1 2 3a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-1.998 2zM14 2H4a1 1 0 0 0-1 1h9.002a2 2 0 0 1 2 2v7A1 1 0 0 0 15 11V3a1 1 0 0 0-1-1zM2.002 4a1 1 0 0 0-1 1v8l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71a.5.5 0 0 1 .577-.094l1.777 1.947V5a1 1 0 0 0-1-1h-10z"}}]})(s)}function H(s){return z({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"256",cy:"256",r:"48"}},{tag:"path",attr:{d:"M470.39 300l-.47-.38-31.56-24.75a16.11 16.11 0 01-6.1-13.33v-11.56a16 16 0 016.11-13.22L469.92 212l.47-.38a26.68 26.68 0 005.9-34.06l-42.71-73.9a1.59 1.59 0 01-.13-.22A26.86 26.86 0 00401 92.14l-.35.13-37.1 14.93a15.94 15.94 0 01-14.47-1.29q-4.92-3.1-10-5.86a15.94 15.94 0 01-8.19-11.82l-5.59-39.59-.12-.72A27.22 27.22 0 00298.76 26h-85.52a26.92 26.92 0 00-26.45 22.39l-.09.56-5.57 39.67a16 16 0 01-8.13 11.82 175.21 175.21 0 00-10 5.82 15.92 15.92 0 01-14.43 1.27l-37.13-15-.35-.14a26.87 26.87 0 00-32.48 11.34l-.13.22-42.77 73.95a26.71 26.71 0 005.9 34.1l.47.38 31.56 24.75a16.11 16.11 0 016.1 13.33v11.56a16 16 0 01-6.11 13.22L42.08 300l-.47.38a26.68 26.68 0 00-5.9 34.06l42.71 73.9a1.59 1.59 0 01.13.22 26.86 26.86 0 0032.45 11.3l.35-.13 37.07-14.93a15.94 15.94 0 0114.47 1.29q4.92 3.11 10 5.86a15.94 15.94 0 018.19 11.82l5.56 39.59.12.72A27.22 27.22 0 00213.24 486h85.52a26.92 26.92 0 0026.45-22.39l.09-.56 5.57-39.67a16 16 0 018.18-11.82c3.42-1.84 6.76-3.79 10-5.82a15.92 15.92 0 0114.43-1.27l37.13 14.95.35.14a26.85 26.85 0 0032.48-11.34 2.53 2.53 0 01.13-.22l42.71-73.89a26.7 26.7 0 00-5.89-34.11zm-134.48-40.24a80 80 0 11-83.66-83.67 80.21 80.21 0 0183.66 83.67z"}}]})(s)}const Y=()=>{const s=B(),t=A(),{createPost:e}=I(),r=F({mutationFn:n=>e(n),onSuccess:n=>{t.setQueryData(["posts",n.id],n),t.invalidateQueries(["posts"],{exact:!0}),s("/")},onError:()=>{K.error("Something went wrong! Couldn't publish your post.")}}),{isPending:l}=r,{user:b}=y.useContext(D),u=async n=>{n.preventDefault();const f=new FormData(n.target);f.append("account",b.user_id),r.mutateAsync(f)};return i.jsx("section",{children:i.jsxs("form",{method:"post",onSubmit:u,className:"w-full",children:[i.jsxs("div",{className:"w-full mb-4 border-b border-gray-100 rounded bg-white dark:bg-gray-900 dark:border-gray-800",children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b dark:border-gray-600",children:[i.jsxs("div",{className:"flex flex-wrap items-center divide-gray-200 sm:divide-x sm:rtl:divide-x-reverse dark:divide-gray-800",children:[i.jsx("div",{className:"flex items-center space-x-1 rtl:space-x-reverse sm:pe-4",children:i.jsxs("button",{type:"button",className:"p-2 text-gray-500 rounded cursor-pointer hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-600",children:[i.jsx(G,{className:"w-4 h-4"}),i.jsx("span",{className:"sr-only",children:"Attach file"})]})}),i.jsx("div",{className:"flex flex-wrap items-center space-x-1 rtl:space-x-reverse sm:ps-4",children:i.jsxs("button",{type:"button",className:"p-2 text-gray-500 rounded cursor-pointer hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-600",children:[i.jsx(H,{className:"w-4 h-4"}),i.jsx("span",{className:"sr-only",children:"Settings"})]})})]}),"l",i.jsxs("div",{id:"tooltip-fullscreen",role:"tooltip",className:"absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700",children:["Show full screen",i.jsx("div",{className:"tooltip-arrow","data-popper-arrow":!0})]})]}),i.jsxs("div",{className:"px-4 py-2 bg-white rounded-b-lg dark:bg-gray-800",children:[i.jsx("label",{htmlFor:"editor",className:"sr-only",children:"Publish post"}),i.jsx("textarea",{id:"editor",rows:"8",name:"content",className:"block w-full px-0 text-sm text-gray-800 bg-white border-0 dark:bg-gray-800 focus:ring-0 dark:text-white dark:placeholder-gray-400",placeholder:"What's on your mind?",defaultValue:"",required:!0})]})]}),i.jsx("div",{className:"px-4",children:i.jsx("button",{type:"submit",disabled:l,className:"bg-primary-600 rounded py-2 disabled:cursor-not-allowed disabled:bg-gray-200 disabled:dark:bg-primary-800 px-5 text-white hover:bg-primary-500",children:l?i.jsx(Q,{sm:!0}):"Post"})})]})})};export{Y as default};
